{% extends "layout.html" %}
{% block title %}Dashboard{% endblock %}
{% block content %}
<h2>Dashboard - Produk Anda</h2>

{% if near_expiry_products %}
    <div class="notification">
        <h3>Produk Mendekati Kadaluarsa!</h3>
        <ul>
            {% for p in near_expiry_products %}
            <li>{{ p[1] }} (exp: {{ p[3] }})</li>
            {% endfor %}
        </ul>
    </div>
{% endif %}

<h3>Tambah Produk Baru</h3>
<form action="{{ url_for('add_product') }}" method="POST" enctype="multipart/form-data">
    <label>Nama Produk</label><br/>
    <input type="text" name="product_name" required /><br/>
    <label>Deskripsi</label><br/>
    <textarea name="description" rows="3"></textarea><br/>
    <label>Tanggal Kadaluarsa</label><br/>
    <input type="date" name="expiry_date" required /><br/>
    <label>Gambar Produk</label><br/>
    <input type="file" name="image" accept="image/*" required /><br/>
    <button type="submit">Tambah Produk</button>
</form>

<hr/>
<h3>Daftar Produk</h3>
<div class="product-list">
    {% for p in products %}
    <div class="product-item">
        <img src="{{ url_for('uploaded_file', filename=p[4]) }}" alt="{{ p[1] }}" width="150" />
        <h4>{{ p[1] }}</h4>
        <p>{{ p[2] }}</p>
        <small>Expired on: {{ p[3] }}</small>
    </div>
    {% else %}
    <p>Belum ada produk yang ditambahkan.</p>
    {% endfor %}
</div>

{% endblock %}
